import{_ as e}from"./InputSearch.f949d82d.js";import{o,d as t,e as a,h as l,r,i as s,j as i,w as d,k as n,F as u,v as c,t as p,C as v,l as m,n as g,z as f,x as b,K as h,y as w}from"./vendor.f30c4ba5.js";import{_ as x,a as y,b as P}from"./DataTableComponent.3e8088c0.js";import{t as M}from"./style.cc01f69b.js";import{u as k,a as F}from"./pedidosDetalles.7298fe1e.js";import{u as C}from"./almacen.518a49f1.js";import{u as D}from"./app.51d37901.js";import{u as _}from"./proceso.020e99df.js";import{u as B}from"./producto.c9516f85.js";import{u as L}from"./utils.5428a5cd.js";const N={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},A=[a("path",{d:"M22 17v2H11v-2h11M19 4.5v5h3L16.5 15L11 9.5h3v-5h5M10.7 15H8.8l-.7-2H4.9l-.7 2H2.3l3.2-9h2l3.2 9m-3.05-3.35L6.5 8l-1.15 3.65h2.3z",fill:"currentColor"},null,-1)];var I={name:"mdi-auto-download",render:function(e,a){return o(),t("svg",N,A)}};const U=a("svg",{id:"Capa_1",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"170",viewBox:"0 0 464.98 464.98",style:{"enable-background":"new 0 0 464.98 464.98"},"xml:space":"preserve"},[a("g",{id:"XMLID_4_"},[a("g",null,[a("polygon",{style:{fill:"#3A75AA"},points:"415.795,273.63 415.795,334.14 389.855,307.64 389.855,247.13"}),a("polygon",{style:{fill:"#3A75AA"},points:"156.745,9 188.975,41.93 87.355,41.93 87.355,73.37 49.185,73.37 49.185,9"}),a("polygon",{style:{fill:"#4489D3"},points:"415.795,436.01 415.795,455.98 49.185,455.98 49.185,82.37 156.735,82.37 415.795,347"}),a("polygon",{style:{fill:"#FFCC73"},points:"380.855,50.93 380.855,298.44 292.465,208.16 343.435,208.16 343.435,199.16\r\n283.655,199.16 248.005,162.73 343.435,162.73 343.435,153.73 239.185,153.73 203.545,117.32 343.435,117.32 343.435,108.32\r\n194.735,108.32 160.525,73.37 96.355,73.37 96.355,50.93"}),a("path",{d:"M424.795,343.34v121.64H40.185V0h120.34l41.05,41.93h188.28v192.33l34.94,35.7v73.37V343.34z M415.795,455.98v-19.97V347\r\nL156.735,82.37H49.185v373.61H415.795z M415.795,334.14v-60.51l-25.94-26.5v60.51L415.795,334.14z M380.855,298.44V50.93h-284.5\r\nv22.44h64.17l34.21,34.95h148.7v9h-139.89l35.64,36.41h104.25v9h-95.43l35.65,36.43h59.78v9h-50.97L380.855,298.44z\r\n M188.975,41.93L156.745,9H49.185v64.37h38.17V41.93H188.975z"})])]),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g"),a("g")],-1),V={class:"row-span-2"},S={class:"text-2xl font-semibold text-black uppercase"},j={class:"text-gray-500"},E={key:0,class:"text-xs text-red-500"},H={class:"h-[100%] w-full flex flex-col"},z={class:"row-span-1"},O=["onClick"],T={class:"bg-white row-span-10 overflow-y-auto h-full w-full"},q={class:"form-container"},R=a("label",{for:"proceso",class:"form-label"},"Proceso",-1),G={key:0},K=["value"],X={key:1,class:"w-full flex flex-col"},Y={class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white"},$={class:"form-container"},J={key:0,class:"flex flex-col"},Q=a("label",{for:"almacen",class:"form-label"},"Almacen",-1),W=["value"],Z={key:1,class:"w-full flex flex-col"},ee={class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white"},oe={class:"form-container"},te=a("label",{for:"observaciones",class:"form-label"},"Observaciones",-1),ae=["disabled"],le=a("input",{type:"submit",class:"hidden"},null,-1),re={class:"relative flex w-full items-center row-span-1"},se={class:"form-container"},ie=a("label",{for:"cantidad",class:"form-label"},"Cantidad",-1),de=c(" Agregar "),ne={class:"rounded-xl overflow-auto bg-white row-span-4"},ue=["onUpdate:modelValue"],ce={key:1,class:"bg-gray-200 p-2 rounded-lg text-gray-300",disabled:""},pe=l({setup(l){const N=k(),A=F(),pe=C(),ve=D(),me=_(),ge=B(),fe=L(),be=r(!1),he=r({}),we=r({}),xe=r({}),ye=r(!1),Pe=r(0),Me=r(!1),ke=r(0),Fe=["Productos del Pedido","Pedido"],Ce=r(!1);s((()=>{N.filterData("")}));const De=e=>{N.filterData(e)},_e=async()=>{xe.value={},we.value={},N.clearModel(),A.clearModel(),pe.setData();const e=await me.setProcesoActivo();if(!e)return M({title:"No tienes procesos disponibles",description:"Habra un proceso por favor! ðŸ‘ðŸ˜Š"},{type:"info",hideProgressBar:!0,position:"bottom-right"}),void(be.value=!1);we.value=e,await ge.filterProductoProcesoLote(we.value.id,""),N.storeModel.Proceso=e.id,N.storeModel.Usuario=ve.getToken().user_id,ke.value=0,fe.setFocusInput("inputSearch")},Be=async({Id:e,Serie:o,Almacen_Id:t,Almacen_Nombre:a,Usuario_Id:l,Fecha:r,Proceso_Id:s,Proceso_Nombre:i,Observaciones:d})=>{if(!e)return void(be.value=!1);Ce.value=!0,await pe.setData();const n=await me.setProcesoActivo();(null==n?void 0:n.id)!==s&&(ye.value=!0),be.value=!0,xe.value={},we.value={},N.clearModel(),A.clearModel(),we.value.id=s,we.value.Nombre=i,N.storeModel.id=e,N.storeModel.Proceso=s,N.storeModel.Serie=o,N.storeModel.Almacen=t,N.storeModel.Usuario=l,N.storeModel.Fecha=r,N.storeModel.Observaciones=d;A.setPedidosDetallesByPedidoId(e)||M({title:"Ocurrio un problema",description:"El pedido no tiene ningun producto!"},{type:"danger",hideProgressBar:!0,position:"bottom-right"}),xe.value.id=t,xe.value.Nombre=a,ke.value=0,fe.setFocusInput("inputSearch"),Ce.value=!1},Le=()=>N.isValidFormModel?A.isValidFormModel?void(Me.value=!0):(M({title:"Formulario incompleto",description:"Por favor ingrese los productos al pedido"},{type:"info",hideProgressBar:!0,position:"bottom-right"}),void(Me.value=!1)):(M({title:"Formulario incompleto",description:"Por favor completa todos los campos"},{type:"info",hideProgressBar:!0,position:"bottom-right"}),void(Me.value=!1)),Ne=async()=>{if(Ce.value=!0,!N.isValidFormModel)return void M({title:"Formulario incompleto",description:"Por favor completa todos los campos"},{type:"info",hideProgressBar:!0,position:"bottom-right"});if(!A.isValidFormModel)return void M({title:"Formulario incompleto",description:"Por favor ingrese los productos al pedido"},{type:"info",hideProgressBar:!0,position:"bottom-right"});const e=await N.saveData();if(!e)return void M({title:"Error al guardar",description:"Por favor intenta nuevamente"},{type:"danger",hideProgressBar:!0,position:"bottom-right"});await A.saveData(e.id)?(M({title:"Guardado",description:"Pedido guardado correctamente"},{type:"success",hideProgressBar:!0,position:"bottom-right"}),Ce.value=be.value=Me.value=!1,N.filterData("")):M({title:"Error al guardar",description:"No se pudieron guardar los productos del pedido"},{type:"danger",hideProgressBar:!0,position:"bottom-right"})},Ae=e=>{be.value=e},Ie=async e=>{await ge.filterProductoProcesoLote(we.value.id,e)},Ue=e=>{he.value=e,setTimeout((()=>{fe.setFocusInput("cantidad")}),100)},Ve=async()=>{if(!he.value.Id)return void M({title:"Seleccione un producto",description:"Por favor!"},{type:"info",hideProgressBar:!0,position:"bottom-right"});if(!Pe.value)return void M({title:"Ingrese la cantidad",description:"Por favor!"},{type:"info",hideProgressBar:!0,position:"bottom-right"});const e={Id:0,Unidad:he.value.Unidad,UnidadText:he.value.Unidad_Nombre,Factor:he.value.Factor,Cantidad:Pe.value,Pedido:0,Lote:he.value.Lote,Lote_Nombre:he.value.Lote_Nombre,Producto:he.value.Id,Producto_Nombre:he.value.Producto_Nombre};if(A.ExistProductoUnidad(e.Producto,e.Unidad))return M({title:"El producto ya estÃ¡ en la lista!"},{type:"info",hideProgressBar:!0,position:"bottom-right"}),he.value={},Pe.value=0,void fe.setFocusInput("inputSearch");A.addList(e)?(he.value={},Pe.value=0,fe.setFocusButton("inputSearch")):M({title:"No se pudo agregar el producto"},{type:"info",hideProgressBar:!0,position:"bottom-right"})},Se=e=>{"Enter"===e.key&&Ve()},je=e=>{A.deleteData(e)};return(l,r)=>{const s=e,M=I,k=P,F=x,C=y;return o(),t(u,null,[i(F,{columns:n(N).getColumns,data:n(N).getData||[],count:n(N).getCounts,titulo:n(N).keyModel,subtitulo:`Listado de ${n(N).keyModel}`,"page-index":n(N).getPageIndex,"show-modal":be.value,"modal-width":"50rem","modal-height":"90%","show-loading":Ce.value,onAddEvent:_e,onUpdateEvent:Be,onFilterEvent:De,onModalIsOpen:Ae},{imagen:d((()=>[U])),cabecera:d((()=>[a("div",V,[a("h1",S,[c(p(n(N).storeModel.id?"Editar":"Nuevo")+" "+p("Pedido")+" ",1),a("b",j,p(n(N).storeModel.id),1)]),ye.value?(o(),t("div",E," Registro de solo lectura ")):v("",!0)])])),cuerpo:d((()=>[a("div",H,[a("section",z,[(o(),t(u,null,m(Fe,((e,o)=>a("button",{key:o,class:g(["text-gray-600 focus:outline-none font-medium rounded-lg p-2 text-xs",{"border-green-500 border-b-2 shadow-lg transition  duration-300 ease-in-out transform hover:-translate-y-1 hover:scale-100":ke.value===o," rounded-none rounded-r-lg":0==o}]),onClick:e=>ke.value=o},p(e),11,O))),64))]),a("section",T,[a("form",{class:g(["form-container w-full h-full p-3",1==ke.value?"grid":"hidden"]),onSubmit:r[3]||(r[3]=f((()=>{}),["prevent"]))},[a("div",q,[R,ye.value?(o(),t("div",X,[a("span",Y,p(we.value.Nombre),1)])):(o(),t("div",G,[b(a("select",{id:"proceso","onUpdate:modelValue":r[0]||(r[0]=e=>n(N).storeModel.Proceso=e),class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white",required:""},[(o(!0),t(u,null,m([we.value],((e,a)=>(o(),t("option",{key:a,value:e.id,class:"text-gray-700","aria-readonly":"true"},p(e.Nombre),9,K)))),128))],512),[[h,n(N).storeModel.Proceso]])]))]),a("div",$,[ye.value?(o(),t("div",Z,[a("span",ee,p(xe.value.Nombre),1)])):(o(),t("div",J,[Q,b(a("select",{id:"almacen","onUpdate:modelValue":r[1]||(r[1]=e=>n(N).storeModel.Almacen=e),class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white",required:""},[(o(!0),t(u,null,m(n(pe).getData,((e,a)=>(o(),t("option",{key:a,value:e.id,class:"text-gray-700"},p(e.Nombre),9,W)))),128))],512),[[h,n(N).storeModel.Almacen]])]))]),a("div",oe,[te,b(a("textarea",{id:"observaciones","onUpdate:modelValue":r[2]||(r[2]=e=>n(N).storeModel.Observaciones=e),class:"form-input w-full focus:text-black bg-white text-gray-500",disabled:ye.value},null,8,ae),[[w,n(N).storeModel.Observaciones]])]),le],34),a("section",{class:g(["form-container h-full p-3 grid grid-rows-5",0==ke.value?"flex":"hidden"])},[a("div",re,[i(s,{field:he.value,"place-holder":"Buscar el producto",class:"w-[50%]",data:n(ge).getProductosProcesoLote,"column-label":"Producto_Nombre",onSelected:Ue,onSearch:Ie},null,8,["field","data"]),a("div",se,[ie,b(a("input",{id:"cantidad","onUpdate:modelValue":r[4]||(r[4]=e=>Pe.value=e),class:"form-input w-full focus:text-black bg-white text-gray-500",type:"number",min:"0",step:"1",onKeydown:Se},null,544),[[w,Pe.value]])]),a("div",null,[a("button",{class:"btn-submit bg-white border border-blue-500 text-blue-500 text-xs flex gap-2",onClick:Ve},[i(M),de])])]),a("section",ne,[i(k,{columns:n(A).getColumns,data:n(A).storeData,actions:!0,class:"row-span-4","link-id":!1,onDeleteRow:je},{Cantidad:d((({index:e})=>[b(a("input",{"onUpdate:modelValue":o=>n(A).storeData[e].Cantidad=o,type:"number",class:"form-input text-center w-24"},null,8,ue),[[w,n(A).storeData[e].Cantidad]])])),_:1},8,["columns","data"])])],2)])])])),acciones:d((()=>[ye.value?(o(),t("button",ce," Solo Lectura ")):(o(),t("button",{key:0,class:"btn-submit text-white font-bold py-2 px-4 rounded-lg",onClick:Le}," Guardar "))])),_:1},8,["columns","data","count","titulo","subtitulo","page-index","show-modal","show-loading"]),i(C,{"show-modal":Me.value,"modal-width":"20rem","modal-height":"10rem",description:"Seguro que desea guardar los datos?",onConfirm:Ne,onCancel:r[5]||(r[5]=e=>Me.value=!1)},null,8,["show-modal"])],64)}}});export{pe as default};
