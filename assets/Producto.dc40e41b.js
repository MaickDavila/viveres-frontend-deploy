import{o as e,d as t,e as o,f as r,r as a,g as i,h as l,i as n,j as d,w as s,k as c,F as u,v as g,t as h,l as p,n as m,z as v,x as f,K as y,y as x,C as b}from"./vendor.f30c4ba5.js";import{u as w,_ as M,a as C,b as I,c as P,d as B}from"./DataTableComponent.970c6a2a.js";import{t as E}from"./style.cc01f69b.js";import{u as V}from"./producto.a86f4e06.js";import{u as F}from"./categoria.42072a24.js";import{i as D}from"./app.88f942b0.js";import{u as U}from"./unidad.840cc792.js";const k={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},z=[o("path",{d:"M4 6h2v12H4V6m3 0h1v12H7V6m2 0h3v12H9V6m4 0h1v12h-1V6m3 0h2v12h-2V6m3 0h1v12h-1V6M2 4v4H0V4a2 2 0 0 1 2-2h4v2H2m20-2a2 2 0 0 1 2 2v4h-2V4h-4V2h4M2 16v4h4v2H2a2 2 0 0 1-2-2v-4h2m20 4v-4h2v4a2 2 0 0 1-2 2h-4v-2h4z",fill:"currentColor"},null,-1)];var j={name:"mdi-barcode-scan",render:function(o,r){return e(),t("svg",k,z)}};const N=r("producto_unidad",(()=>{const e="producto_unidad",t=a([{}]),o=a({}),r=i((()=>t.value)),l=i((()=>t.value.length>0)),n=e=>t.value.findIndex((t=>t.UnidadId===e))>-1;return{keyModel:e,storeModel:o,getData:r,getColumns:[{Key:"Unidad",Text:"Unidad",Width:10,Align:"left",FormatMoney:!1},{Key:"Factor",Text:"Factor",Width:10,Align:"left",FormatMoney:!1},{Key:"Principal",Text:"Principal",Width:10,Align:"left",FormatMoney:!1}],isValidFormModel:l,saveData:async o=>{try{if(!l.value)return null;let r=(e=>t.value.filter((e=>e.Id>0)).map((t=>({id:t.Id,Producto:e,Unidad:t.UnidadId,Factor:t.Factor,Precio:t.Precio,IsPrincipal:t.IsPrincipal}))))(o),a=null;return r.length&&(a=await D.put(`${e}/`,r)),r=(e=>t.value.filter((e=>0===e.Id)).map((t=>({id:0,Producto:e,Unidad:t.UnidadId,Factor:t.Factor,Precio:t.Precio,IsPrincipal:t.IsPrincipal}))))(o),r.length>0&&(a=await D.post(`${e}/`,r)),null==a?void 0:a.data}catch(r){return console.error(r),null}},ExistUnidad:n,addList:e=>{try{if(n(e.UnidadId))return!1;const o=t.value.findIndex((t=>t===e));return-1===o?t.value.push(e):t.value[o]=e,!0}catch(o){return!1}},deleteData:async o=>{try{let r=t.value.findIndex((e=>e===o));return r>-1&&o.Id>0&&await D.delete(`${e}/${o.Id}/`),r=t.value.findIndex((e=>e.UnidadId===o.UnidadId)),r>-1&&t.value.splice(r,1),!0}catch(r){return console.error(r),!1}},setProductoUnidadByProductoId:async e=>{try{const{data:o}=await D.get("get_producto_unidad_by_producto_id",{params:{productoId:e}});return t.value=o,o}catch(o){return console.error(o),null}},clearModel:()=>{o.value={},t.value=[]}}})),H=o("svg",{x:"0px",y:"0px",width:"170",viewBox:"0 0 57.293 57.293",style:{"enable-background":"new 0 0 57.293 57.293"},"xml:space":"preserve"},[o("g",null,[o("path",{style:{fill:"#FFFFFF"},d:"M28.646,25.293c1.304,0,2.416-1,2.829-2h-5.657C26.23,24.293,27.342,25.293,28.646,25.293z"}),o("polygon",{style:{fill:"#66CEDB"},points:"37.028,27.293 19.646,27.293 8.646,27.293 7.264,27.293 3.264,35.293 33.028,35.293 "}),o("path",{style:{fill:"#66CEDB"},d:"M33.646,37.293h-26v14.708c0,1.654,1.346,3.292,3,3.292h7V44.001c0-0.347,0.18-0.668,0.474-0.851\r\nc0.295-0.184,0.663-0.198,0.973-0.044l1.553,0.776l1.552-0.776c0.281-0.141,0.612-0.141,0.895,0l1.553,0.776l1.553-0.776\r\nc0.31-0.154,0.678-0.14,0.973,0.044c0.294,0.183,0.474,0.504,0.474,0.851v11.292h10V30.237l-3.106,6.357\r\nC34.371,36.933,34.026,37.293,33.646,37.293z"}),o("path",{style:{fill:"#EE8B26"},d:"M24.199,45.895l-1.553-0.776l-1.552,0.776c-0.281,0.141-0.613,0.141-0.895,0l-0.553-0.276v9.674h6\r\nv-9.674l-0.553,0.276C24.813,46.036,24.482,46.036,24.199,45.895z"}),o("path",{style:{fill:"#66CEDB"},d:"M42.751,36.594l-3.105-6.357v25.056h7c1.654,0,3-1.638,3-3.292V37.293h-6\r\nC43.267,37.293,42.922,36.933,42.751,36.594z"}),o("path",{style:{fill:"#F8CF26"},d:"M23.646,22.293c0-0.553,0.448-1,1-1h8c0.552,0,1,0.447,1,1c0,1.13-0.391,2-1.026,3h4.026v-8.292\r\nc0-1.655-1.346-2.708-3-2.708h-10c-1.654,0-3,1.053-3,2.708v8.292h4.026C24.038,24.293,23.646,23.423,23.646,22.293z\r\n M31.646,17.001c0.552,0,1,0.448,1,1s-0.448,1-1,1s-1-0.448-1-1C30.646,17.448,31.094,17.001,31.646,17.001z M25.646,17.001\r\nc0.552,0,1,0.448,1,1s-0.448,1-1,1s-1-0.448-1-1C24.646,17.448,25.094,17.001,25.646,17.001z"}),o("polygon",{style:{fill:"#66CEDB"},points:"48.646,27.293 40.264,27.293 44.264,35.293 54.028,35.293 50.028,27.293 "}),o("g",null,[o("path",{d:"M51.541,25.699c-0.169-0.338-0.515-0.406-0.894-0.406h-2h-10v-8.292c0-2.757-2.243-4.708-5-4.708h-10\r\nc-2.757,0-5,1.951-5,4.708v8.292h-10h-2c-0.379,0-0.725,0.068-0.895,0.406l-5,9.927c-0.155,0.31-0.138,0.787,0.044,1.082\r\nc0.182,0.296,0.504,0.585,0.851,0.585h4v14.708c0,2.756,2.243,5.292,5,5.292h8h8h12h8c2.757,0,5-2.536,5-5.292V37.293h4\r\nc0.347,0,0.668-0.326,0.851-0.621c0.182-0.295,0.199-0.663,0.044-0.973L51.541,25.699z M20.646,17.001\r\nc0-1.655,1.346-2.708,3-2.708h10c1.654,0,3,1.053,3,2.708v8.292H32.62c0.635-1,1.026-1.87,1.026-3c0-0.553-0.448-1-1-1h-8\r\nc-0.552,0-1,0.447-1,1c0,1.13,0.391,2,1.026,3h-4.026V17.001z M25.817,23.293h5.657c-0.413,1-1.525,2-2.829,2\r\nC27.342,25.293,26.23,24.293,25.817,23.293z M7.264,27.293h1.382h11h17.382l-4,8H3.264L7.264,27.293z M7.646,52.001V37.293h26\r\nc0.379,0,0.725-0.36,0.894-0.699l3.106-6.357v25.056h-10V44.001c0-0.347-0.18-0.668-0.474-0.851\r\nc-0.295-0.184-0.664-0.198-0.973-0.044l-1.553,0.776l-1.553-0.776c-0.282-0.141-0.613-0.141-0.895,0l-1.552,0.776l-1.553-0.776\r\nc-0.31-0.154-0.678-0.14-0.973,0.044c-0.294,0.183-0.474,0.504-0.474,0.851v11.292h-7C8.992,55.293,7.646,53.655,7.646,52.001z\r\n M19.646,55.293v-9.674l0.553,0.276c0.281,0.141,0.613,0.141,0.895,0l1.552-0.776l1.553,0.776c0.282,0.141,0.613,0.141,0.895,0\r\nl0.552-0.276v9.674H19.646z M49.646,52.001c0,1.654-1.346,3.292-3,3.292h-7V30.237l3.105,6.357\r\nc0.17,0.339,0.516,0.699,0.895,0.699h6V52.001z M44.264,35.293l-4-8h8.382h1.382l4,8H44.264z"}),o("circle",{cx:"25.646",cy:"18.001",r:"1"}),o("circle",{cx:"31.646",cy:"18.001",r:"1"}),o("path",{d:"M8.646,23.293h2c0-6-4.486-10.292-10-10.292v2C5.057,15.001,8.646,18.293,8.646,23.293z"}),o("path",{d:"M12.646,14.293h2c0-8-5.832-13.293-13-13.293v2C7.711,3,12.646,7.293,12.646,14.293z"}),o("path",{d:"M23.646,10.293h2c0-5-4.038-9.292-9-9.292v2C20.507,3,23.646,6.293,23.646,10.293z"}),o("path",{d:"M46.646,23.293h2c0-5,3.589-8.292,8-8.292v-2C51.132,13.001,46.646,17.293,46.646,23.293z"}),o("path",{d:"M55.646,3V1c-7.169,0-13,5.293-13,13.293h2C44.646,7.293,49.582,3,55.646,3z"}),o("path",{d:"M40.646,3V1c-4.962,0-9,4.293-9,9.293h2C33.646,6.293,36.786,3,40.646,3z"}),o("rect",{x:"12.646",y:"16.001",width:"2",height:"2"}),o("rect",{x:"12.646",y:"20.001",width:"2",height:"2"}),o("rect",{x:"42.646",y:"16.001",width:"2",height:"2"}),o("rect",{x:"42.646",y:"20.001",width:"2",height:"2"}),o("rect",{x:"12.646",y:"1",width:"2",height:"2"}),o("rect",{x:"42.646",y:"1",width:"2",height:"2"}),o("rect",{x:"27.646",y:"8.001",width:"2",height:"2"}),o("rect",{x:"27.646",y:"4",width:"2",height:"2"}),o("rect",{x:"27.646",width:"2",height:"2"}),o("rect",{x:"17.646",y:"8.001",width:"2",height:"2"}),o("rect",{x:"37.646",y:"8.001",width:"2",height:"2"})])]),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g"),o("g")],-1),_={class:"text-2xl font-semibold uppercase p-3"},A={class:"text-gray-500"},L={class:"h-[100%] w-full flex flex-col"},$={class:"row-span-1"},q=["onClick"],S={class:"bg-white h-full row-span-10 overflow-y-auto"},K={class:"form-container"},O=["src"],R=o("p",{class:"text-gray-500 text-xs italic"}," Imagen referencial del producto. ",-1),T={class:"form-container"},W=o("label",{for:"categoria",class:"form-label"},"Categoria",-1),G=["value"],Y={class:"form-container"},J=o("label",{for:"txtNombre",class:"form-label"},"Nombre del Producto:",-1),Q={class:"form-container"},X={for:"txtCodigoBarra",class:"form-label flex gap-2"},Z=g("Codigo de Barra: "),ee={class:"row-span-1 flex items-center w-full"},te={class:"form-container w-1/2"},oe=o("label",{for:"unidad",class:"form-label"},"Unidad",-1),re=["value"],ae={class:"mt-4"},ie={class:"grid grid-cols-2 items-center px-5 row-span-1 bg-gray-100"},le=g(" Agregar Presentaciones "),ne=g(" Configurar el producto "),de=l({setup(r){const i=V(),l=F(),D=U(),k=N(),z=w(),de=a(!1),se=a(!1),ce=a(0),ue=a({}),ge=["Producto","Presentaciones"],he=a({}),pe=a(!1);n((()=>{i.filterData("")}));const me=()=>(Math.floor(9e5*Math.random())+1e5).toString(),ve=e=>{i.filterData(e)},fe=async()=>{i.clearModel(),k.clearModel(),i.storeModel.CodigoBarra=me(),await l.setData(),await D.setData()},ye=async({Id:e,Nombre:t,Categoria_Id:o,CodigoBarra:r,Imagen:a})=>{var n;if(!e)return void(de.value=!1);i.clearModel(),k.clearModel(),await l.setData(),await D.setData();const d=l.getData.find((e=>e.id===o));d||E({title:"Error",description:"No se pudo cargar la categoria!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),i.storeModel.id=e,i.storeModel.Categoria=null!=(n=null==d?void 0:d.id)?n:0,i.storeModel.Nombre=t,i.storeModel.CodigoBarra=r||me(),i.storeModel.Imagen=a;await k.setProductoUnidadByProductoId(e)||E({title:"Error",description:"No se pudo cargar las presentaciones!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),de.value=!0},xe=async()=>{if(!i.isValidFormModel)return E({title:"Error",description:"El formulario de Producto es inv√°lido!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(pe.value=!1);if(!k.isValidFormModel)return E({title:"Error",description:"Ingrese las presentaciones del producto!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(pe.value=!1);se.value=!0;const e=await i.saveData();if(!e)return E({title:"Error",description:"Ingrese las presentaciones del producto!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(se.value=!1);const t=e;if(!(await k.saveData(t.id)))return E({title:"Error",description:"Ingrese las presentaciones del producto!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(se.value=!1);de.value=pe.value=!1,E({title:"Exitoso",description:"Operaci√≥n completada con √©xito! üòä"},{type:"success",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),se.value=!1,i.filterData("")},be=e=>{de.value=e,ce.value=0},we=e=>{if(!e)return"";return 0===e.indexOf("data:image")?e:`${z.getBaseMediaUrl}${e}`},Me=async e=>{await k.deleteData(e)?E({title:"Exitoso",description:"El registro se ha eliminado correctamente"},{type:"success",timeout:3e3,position:"bottom-right",hideProgressBar:!0}):E({title:"Error",description:"No se pudo eliminar el registro"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0})};return(r,a)=>{const n=j,w=I,V=P,F=B,U=M,z=C;return e(),t(u,null,[d(U,{columns:c(i).getColumns,data:c(i).getData||[],count:c(i).getCounts,titulo:c(i).keyModel,subtitulo:`Listado de ${c(i).keyModel}s`,"show-modal":de.value,"modal-width":"50rem","modal-height":"80%","show-loading":se.value,onAddEvent:fe,onUpdateEvent:ye,onFilterEvent:ve,onModalIsOpen:be},{imagen:s((()=>[H])),cabecera:s((()=>[o("h1",_,[g(h(c(i).storeModel.id?"Editar":"Nuevo")+" "+h(c(i).keyModel)+" ",1),o("b",A,h(c(i).storeModel.id),1)])])),cuerpo:s((()=>[o("div",L,[o("section",$,[(e(),t(u,null,p(ge,((e,t)=>o("button",{key:t,class:m(["text-gray-600 focus:outline-none font-medium rounded-lg p-2 text-xs",{"border-green-500 border-b-2 shadow-lg transition  duration-300 ease-in-out transform hover:-translate-y-1 hover:scale-100":ce.value===t," rounded-none rounded-r-lg":0==t}]),onClick:e=>ce.value=t},h(e),11,q))),64))]),o("section",S,[o("form",{class:m(["form-container h-full p-3",0==ce.value?"grid":"hidden"]),onSubmit:a[5]||(a[5]=v((()=>{}),["prevent"]))},[o("input",{id:"file",class:"hidden",type:"file",placeholder:"Imagen",accept:"image/png, image/jpeg, image/jpg",onChange:a[0]||(a[0]=e=>(async()=>{const e=document.getElementById("file");if(!e)return;const t=e.files;if(!t)return;const o=t[0];if(!o)return;const r=new FileReader;"image/png"===o.type||"image/jpeg"===o.type||"image/webp"===o.type?o.size>1e6?E({title:"Error",description:"El archivo no puede ser mayor a 1mb"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}):(r.readAsDataURL(o),r.onload=()=>{i.storeModel.Imagen=r.result}):E({title:"Error",description:"Solo se aceptan formatos .png, .jpg y .jpeg"},{type:"warning",timeout:3e3,position:"bottom-right",hideProgressBar:!0})})())},null,32),o("div",K,[o("div",{class:"rounded-lg w-[150px] h-[130px] flex flex-col items-center justify-center m-auto",onClick:a[1]||(a[1]=e=>(()=>{const e=document.getElementById("file");e&&e.click()})())},[o("img",{class:"w-[85%] h-[85%] bg-cover flex text-center items-center justify-center rounded-lg",src:we(c(i).storeModel.Imagen),alt:"imagen"},null,8,O),R])]),o("div",T,[W,f(o("select",{id:"categoria","onUpdate:modelValue":a[2]||(a[2]=e=>c(i).storeModel.Categoria=e),class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white",required:""},[(e(!0),t(u,null,p(c(l).getData,((o,r)=>(e(),t("option",{key:r,value:o.id,class:"text-gray-700"},h(o.Nombre),9,G)))),128))],512),[[y,c(i).storeModel.Categoria]])]),o("div",Y,[J,f(o("input",{id:"txtNombre","onUpdate:modelValue":a[3]||(a[3]=e=>c(i).storeModel.Nombre=e),autofocus:"",type:"text",class:"form-input sm:w-full lg:w-[100%]",placeholder:"Nombre del Producto",required:""},null,512),[[x,c(i).storeModel.Nombre]])]),o("div",Q,[o("label",X,[Z,d(n,{class:"font-bold"})]),f(o("input",{id:"txtCodigoBarra","onUpdate:modelValue":a[4]||(a[4]=e=>c(i).storeModel.CodigoBarra=e),type:"text",class:"form-input w-full",placeholder:"Codigo de Barra",required:""},null,512),[[x,c(i).storeModel.CodigoBarra]])])],34),o("section",{class:m(["form-container h-full p-3 grid grid-rows-5",1==ce.value?"flex":"hidden"])},[o("div",ee,[o("div",te,[oe,f(o("select",{id:"unidad","onUpdate:modelValue":a[6]||(a[6]=e=>ue.value=e),class:"form-input w-full focus:text-black bg-gray-500 text-white",required:""},[(e(!0),t(u,null,p(c(D).getData,((o,r)=>(e(),t("option",{key:r,value:o,class:"text-gray-700"},h(o.Nombre),9,re)))),128))],512),[[y,ue.value]])]),o("div",ae,[o("button",{class:"btn-submit",onClick:a[7]||(a[7]=e=>(()=>{var e;if(!ue.value)return;const t={Id:null!=(e=he.value.Id)?e:0,UnidadId:ue.value.id,Unidad:ue.value.Nombre,Factor:ue.value.Factor,Precio:0,IsPrincipal:0===k.getData.length};if(t.Principal=t.IsPrincipal?"S√≠":"No",k.ExistUnidad(t.UnidadId))return void E({title:"Unidad Existe",description:"La unidad ya est√° en la lista! üòä"},{type:"danger",position:"bottom-right",hideProgressBar:!0});k.addList(t)||E({title:"Ocurrio un problema",description:"No se pudo agregar la unidad a la lista!"},{type:"danger"}),ue.value={}})())}," Guardar ")])]),d(w,{columns:c(k).getColumns||[],data:c(k).getData||[],actions:!0,class:"row-span-4","link-id":!1,onDeleteRow:Me},null,8,["columns","data"])],2)])])])),acciones:s((()=>[o("div",ie,[o("button",{class:"btn-submit text-white font-bold py-2 px-4 rounded-lg",onClick:a[8]||(a[8]=e=>i.isValidFormModel?k.isValidFormModel?void(pe.value=!0):(E({title:"Error",description:"Ingrese las presentaciones del producto!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(pe.value=!1)):(E({title:"Error",description:"El formulario de Producto es inv√°lido!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(pe.value=!1)))}," Guardar "),0==ce.value?(e(),t("button",{key:0,class:"text-xs text-gray-800 text-center bg-blue-100 px-2 p-1 rounded-lg underline text-left flex items-center justify-center",onClick:a[9]||(a[9]=e=>ce.value=1)},[le,d(V)])):b("",!0),1==ce.value?(e(),t("button",{key:1,class:"text-xs text-gray-800 text-center bg-red-100 px-2 p-1 rounded-lg underline text-left flex items-center justify-center",onClick:a[10]||(a[10]=e=>ce.value=0)},[d(F),ne])):b("",!0)])])),_:1},8,["columns","data","count","titulo","subtitulo","show-modal","show-loading"]),d(z,{"show-modal":pe.value,"modal-width":"20rem","modal-height":"10rem",description:"Seguro que desea guardar los datos?",onConfirm:xe,onCancel:a[11]||(a[11]=e=>pe.value=!1)},null,8,["show-modal"])],64)}}});export{de as default};
