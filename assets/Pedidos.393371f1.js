import{_ as e}from"./DataTableComponent.64a02618.js";import{f as o,r as a,g as t,h as l,i as s,o as r,s as i,w as n,k as d,e as c,v as u,t as v,d as m,C as g,x as p,K as f,F as b,l as x,y as h,z as y}from"./vendor.f30c4ba5.js";import{t as w}from"./style.cc01f69b.js";import{i as M,u as k}from"./app.a9edc286.js";import{u as A}from"./almacen.8ddf1196.js";import{u as P}from"./proceso.5a4287ff.js";const D=o("pedidos",(()=>{const e="pedidos",o=a({}),l=a({}),s=a(1),r=t((()=>o.value.results)),i=t((()=>o.value.count)),n=t((()=>s.value)),d=t((()=>{const{Almacen:e,Usuario:o,Proceso:a}=l.value;return e>0&&o>0&&a>0}));return{keyModel:e,storeModel:l,getData:r,getCounts:i,getColumns:[{Key:"Id",Text:"Id",Width:10},{Key:"Proceso_Nombre",Text:"Proceso",Width:10},{Key:"Serie",Text:"Serie",Width:90},{Key:"Fecha",Text:"Fecha",Width:90},{Key:"Almacen_Nombre",Text:"Almacen",Width:90},{Key:"Usuario_Nombre",Text:"Usuario",Width:90}],getPageIndex:n,isValidFormModel:d,saveData:async()=>{try{if(!d.value)return null;let e=null;return e=l.value.id?await M.put(`pedidos/${l.value.id}/`,l.value):await M.post("pedidos/",l.value),e.data}catch(e){return console.error(e),null}},filterData:async e=>{try{const{data:a}=await M.get("filter_pedidos",{params:{text:e}});return o.value=a,a}catch(a){return console.error(a),null}},clearModel:()=>{l.value={}}}})),_=c("svg",{id:"Capa_1",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"170",viewBox:"0 0 464.98 464.98",style:{"enable-background":"new 0 0 464.98 464.98"},"xml:space":"preserve"},[c("g",{id:"XMLID_4_"},[c("g",null,[c("polygon",{style:{fill:"#3A75AA"},points:"415.795,273.63 415.795,334.14 389.855,307.64 389.855,247.13"}),c("polygon",{style:{fill:"#3A75AA"},points:"156.745,9 188.975,41.93 87.355,41.93 87.355,73.37 49.185,73.37 49.185,9"}),c("polygon",{style:{fill:"#4489D3"},points:"415.795,436.01 415.795,455.98 49.185,455.98 49.185,82.37 156.735,82.37 415.795,347"}),c("polygon",{style:{fill:"#FFCC73"},points:"380.855,50.93 380.855,298.44 292.465,208.16 343.435,208.16 343.435,199.16\r\n283.655,199.16 248.005,162.73 343.435,162.73 343.435,153.73 239.185,153.73 203.545,117.32 343.435,117.32 343.435,108.32\r\n194.735,108.32 160.525,73.37 96.355,73.37 96.355,50.93"}),c("path",{d:"M424.795,343.34v121.64H40.185V0h120.34l41.05,41.93h188.28v192.33l34.94,35.7v73.37V343.34z M415.795,455.98v-19.97V347\r\nL156.735,82.37H49.185v373.61H415.795z M415.795,334.14v-60.51l-25.94-26.5v60.51L415.795,334.14z M380.855,298.44V50.93h-284.5\r\nv22.44h64.17l34.21,34.95h148.7v9h-139.89l35.64,36.41h104.25v9h-95.43l35.65,36.43h59.78v9h-50.97L380.855,298.44z\r\n M188.975,41.93L156.745,9H49.185v64.37h38.17V41.93H188.975z"})])]),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g"),c("g")],-1),F={class:"row-span-2"},I={class:"text-2xl font-semibold text-black uppercase"},C={class:"text-gray-500"},N={key:0,class:"text-xs text-red-500"},U=["onSubmit"],V={class:"form-container"},E=c("label",{for:"proceso",class:"form-label"},"Proceso",-1),T={key:0},K=["value"],j={key:1,class:"w-full flex flex-col"},z={class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white"},L={class:"form-container"},O=c("label",{for:"almacen",class:"form-label"},"Almacen",-1),S=["value"],W={class:"form-container"},H=c("label",{for:"observaciones",class:"form-label"},"Observaciones",-1),q=c("input",{type:"submit",class:"hidden"},null,-1),B=l({setup(o){const t=D(),l=A(),M=k(),B=P(),$=a(!1),G=a({}),R=a(!1),X=a(!1);s((()=>{t.filterData("")}));const J=e=>{t.filterData(e)},Q=async()=>{t.clearModel(),l.setData();const e=await B.setProcesoActivo();e&&(G.value=e,t.storeModel.Proceso=e.id,t.storeModel.Usuario=M.getToken().user_id)},Y=async({Id:e,Serie:o,Almacen_Id:a,Usuario_Id:s,Fecha:r,Proceso_Id:i,Proceso_Nombre:n,Observaciones:d})=>{if(!e)return void($.value=!1);await l.setData();const c=await B.setProcesoActivo();(null==c?void 0:c.id)!==i&&(R.value=!0),G.value.id=i,G.value.Nombre=n,$.value=!0,t.clearModel(),t.storeModel.id=e,t.storeModel.Proceso=i,t.storeModel.Serie=o,t.storeModel.Almacen=a,t.storeModel.Usuario=s,t.storeModel.Fecha=r,t.storeModel.Observaciones=d},Z=async()=>{let e="",o="",a=!0;if(t.isValidFormModel){X.value=!0;await t.saveData()?(e="Exitoso",o="El registro se ha guardado correctamente",$.value=!1):(e="Error",o="No se pudo guardar el registro")}else e="Error",o="Ingrese los valores del Formulario",a=!1;w({title:e,description:o},{type:a?"success":"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),X.value=!1,t.filterData("")},ee=e=>{$.value=e};return(o,a)=>{const s=e;return r(),i(s,{columns:d(t).getColumns,data:d(t).getData||[],count:d(t).getCounts,titulo:d(t).keyModel,subtitulo:`Listado de ${d(t).keyModel}`,"page-index":d(t).getPageIndex,"show-modal":$.value,"modal-width":"50rem","modal-height":"50rem","show-loading":X.value,onAddEvent:Q,onUpdateEvent:Y,onFilterEvent:J,onModalIsOpen:ee},{imagen:n((()=>[_])),cabecera:n((()=>[c("div",F,[c("h1",I,[u(v(d(t).storeModel.id?"Editar":"Nuevo")+" "+v("Pedido")+" ",1),c("b",C,v(d(t).storeModel.id),1)]),R.value?(r(),m("div",N," Registro de solo lectura ")):g("",!0)])])),cuerpo:n((()=>[c("form",{class:"flex flex-col",onSubmit:y(Z,["prevent"])},[c("div",V,[E,R.value?(r(),m("div",j,[c("span",z,v(G.value.Nombre),1)])):(r(),m("div",T,[p(c("select",{id:"proceso","onUpdate:modelValue":a[0]||(a[0]=e=>d(t).storeModel.Proceso=e),class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white",required:""},[(r(!0),m(b,null,x([G.value],((e,o)=>(r(),m("option",{key:o,value:e.id,class:"text-gray-700","aria-readonly":"true"},v(e.Nombre),9,K)))),128))],512),[[f,d(t).storeModel.Proceso]])]))]),c("div",L,[O,p(c("select",{id:"almacen","onUpdate:modelValue":a[1]||(a[1]=e=>d(t).storeModel.Almacen=e),class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white",required:""},[(r(!0),m(b,null,x(d(l).getData,((e,o)=>(r(),m("option",{key:o,value:e.id,class:"text-gray-700"},v(e.Nombre),9,S)))),128))],512),[[f,d(t).storeModel.Almacen]])]),c("div",W,[H,p(c("textarea",{id:"observaciones","onUpdate:modelValue":a[2]||(a[2]=e=>d(t).storeModel.Observaciones=e),class:"form-input w-full focus:text-black bg-white text-gray-500"},null,512),[[h,d(t).storeModel.Observaciones]])]),q],40,U)])),acciones:n((()=>[R.value?g("",!0):(r(),m("button",{key:0,class:"btn-submit text-white font-bold py-2 px-4 rounded-lg",onClick:Z}," Guardar "))])),_:1},8,["columns","data","count","titulo","subtitulo","page-index","show-modal","show-loading"])}}});export{B as default};
