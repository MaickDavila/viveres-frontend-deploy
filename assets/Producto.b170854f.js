import{o as e,d as t,h as r,e as o,r as a,f as i,g as l,k as n,p as d,x as s,y as c,t as u,i as g,F as h,l as p,n as m,B as v,z as f,I as x,A as y,j as w,s as b}from"./vendor.596c221c.js";import{a as M,_ as C,b as I}from"./DataTableComponent.25d3a263.js";/* empty css              */import{u as P}from"./producto.ed9cb69e.js";import{u as B}from"./categoria.197fd29f.js";import{i as E}from"./app.a2d3cf95.js";import{u as V}from"./utils.062368f7.js";import{u as k}from"./unidad.2b8b1256.js";const F={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},z=[r("path",{d:"M4 6h2v12H4V6m3 0h1v12H7V6m2 0h3v12H9V6m4 0h1v12h-1V6m3 0h2v12h-2V6m3 0h1v12h-1V6M2 4v4H0V4a2 2 0 0 1 2-2h4v2H2m20-2a2 2 0 0 1 2 2v4h-2V4h-4V2h4M2 16v4h4v2H2a2 2 0 0 1-2-2v-4h2m20 4v-4h2v4a2 2 0 0 1-2 2h-4v-2h4z",fill:"currentColor"},null,-1)];var D={name:"mdi-barcode-scan",render:function(r,o){return e(),t("svg",F,z)}};const U={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},_=[r("path",{d:"M4 11v2h12l-5.5 5.5l1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5L16 11H4z",fill:"currentColor"},null,-1)];var j={name:"mdi-arrow-right",render:function(r,o){return e(),t("svg",U,_)}};const N={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},L=[r("path",{d:"M20 11v2H8l5.5 5.5l-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5L8 11h12z",fill:"currentColor"},null,-1)];var H={name:"mdi-arrow-left",render:function(r,o){return e(),t("svg",N,L)}};const A=o("producto_unidad",(()=>{const e="producto_unidad",t=a([{}]),r=a({}),o=i((()=>t.value)),l=i((()=>t.value.length>0)),n=e=>t.value.findIndex((t=>t.UnidadId===e))>-1;return{keyModel:e,storeModel:r,getData:o,getColumns:[{Key:"Unidad",Text:"Unidad",Width:10,Align:"left",FormatMoney:!1},{Key:"Factor",Text:"Factor",Width:10,Align:"left",FormatMoney:!1},{Key:"Principal",Text:"Principal",Width:10,Align:"left",FormatMoney:!1}],isValidFormModel:l,saveData:async r=>{try{if(!l.value)return null;let o=(e=>t.value.filter((e=>e.Id>0)).map((t=>({id:t.Id,Producto:e,Unidad:t.UnidadId,Factor:t.Factor,Precio:t.Precio,IsPrincipal:t.IsPrincipal}))))(r),a=null;return o.length>0&&(a=await E.put(`${e}/`,o)),o=(e=>t.value.filter((e=>0===e.Id)).map((t=>({id:0,Producto:e,Unidad:t.UnidadId,Factor:t.Factor,Precio:t.Precio,IsPrincipal:t.IsPrincipal}))))(r),o.length>0&&(a=await E.post(`${e}/`,o)),null==a?void 0:a.data}catch(o){return console.error(o),null}},ExistUnidad:n,addList:e=>{try{if(n(e.UnidadId))return!1;const r=t.value.findIndex((t=>t===e));return-1===r?t.value.push(e):t.value[r]=e,!0}catch(r){return!1}},deleteData:async r=>{try{let o=t.value.findIndex((e=>e===r));return o>-1&&r.Id>0&&await E.delete(`${e}/${r.Id}/`),o=t.value.findIndex((e=>e.UnidadId===r.UnidadId)),o>-1&&t.value.splice(o,1),!0}catch(o){return console.error(o),!1}},get_producto_unidad_by_producto_id:async e=>{try{const{data:r}=await E.get("get_producto_unidad_by_producto_id",{params:{productoId:e}});return t.value=r,r}catch(r){return console.error(r),null}},clearModel:()=>{r.value={},t.value=[]}}})),$=r("svg",{x:"0px",y:"0px",width:"170",viewBox:"0 0 57.293 57.293",style:{"enable-background":"new 0 0 57.293 57.293"},"xml:space":"preserve"},[r("g",null,[r("path",{style:{fill:"#FFFFFF"},d:"M28.646,25.293c1.304,0,2.416-1,2.829-2h-5.657C26.23,24.293,27.342,25.293,28.646,25.293z"}),r("polygon",{style:{fill:"#66CEDB"},points:"37.028,27.293 19.646,27.293 8.646,27.293 7.264,27.293 3.264,35.293 33.028,35.293 "}),r("path",{style:{fill:"#66CEDB"},d:"M33.646,37.293h-26v14.708c0,1.654,1.346,3.292,3,3.292h7V44.001c0-0.347,0.18-0.668,0.474-0.851\r\nc0.295-0.184,0.663-0.198,0.973-0.044l1.553,0.776l1.552-0.776c0.281-0.141,0.612-0.141,0.895,0l1.553,0.776l1.553-0.776\r\nc0.31-0.154,0.678-0.14,0.973,0.044c0.294,0.183,0.474,0.504,0.474,0.851v11.292h10V30.237l-3.106,6.357\r\nC34.371,36.933,34.026,37.293,33.646,37.293z"}),r("path",{style:{fill:"#EE8B26"},d:"M24.199,45.895l-1.553-0.776l-1.552,0.776c-0.281,0.141-0.613,0.141-0.895,0l-0.553-0.276v9.674h6\r\nv-9.674l-0.553,0.276C24.813,46.036,24.482,46.036,24.199,45.895z"}),r("path",{style:{fill:"#66CEDB"},d:"M42.751,36.594l-3.105-6.357v25.056h7c1.654,0,3-1.638,3-3.292V37.293h-6\r\nC43.267,37.293,42.922,36.933,42.751,36.594z"}),r("path",{style:{fill:"#F8CF26"},d:"M23.646,22.293c0-0.553,0.448-1,1-1h8c0.552,0,1,0.447,1,1c0,1.13-0.391,2-1.026,3h4.026v-8.292\r\nc0-1.655-1.346-2.708-3-2.708h-10c-1.654,0-3,1.053-3,2.708v8.292h4.026C24.038,24.293,23.646,23.423,23.646,22.293z\r\n M31.646,17.001c0.552,0,1,0.448,1,1s-0.448,1-1,1s-1-0.448-1-1C30.646,17.448,31.094,17.001,31.646,17.001z M25.646,17.001\r\nc0.552,0,1,0.448,1,1s-0.448,1-1,1s-1-0.448-1-1C24.646,17.448,25.094,17.001,25.646,17.001z"}),r("polygon",{style:{fill:"#66CEDB"},points:"48.646,27.293 40.264,27.293 44.264,35.293 54.028,35.293 50.028,27.293 "}),r("g",null,[r("path",{d:"M51.541,25.699c-0.169-0.338-0.515-0.406-0.894-0.406h-2h-10v-8.292c0-2.757-2.243-4.708-5-4.708h-10\r\nc-2.757,0-5,1.951-5,4.708v8.292h-10h-2c-0.379,0-0.725,0.068-0.895,0.406l-5,9.927c-0.155,0.31-0.138,0.787,0.044,1.082\r\nc0.182,0.296,0.504,0.585,0.851,0.585h4v14.708c0,2.756,2.243,5.292,5,5.292h8h8h12h8c2.757,0,5-2.536,5-5.292V37.293h4\r\nc0.347,0,0.668-0.326,0.851-0.621c0.182-0.295,0.199-0.663,0.044-0.973L51.541,25.699z M20.646,17.001\r\nc0-1.655,1.346-2.708,3-2.708h10c1.654,0,3,1.053,3,2.708v8.292H32.62c0.635-1,1.026-1.87,1.026-3c0-0.553-0.448-1-1-1h-8\r\nc-0.552,0-1,0.447-1,1c0,1.13,0.391,2,1.026,3h-4.026V17.001z M25.817,23.293h5.657c-0.413,1-1.525,2-2.829,2\r\nC27.342,25.293,26.23,24.293,25.817,23.293z M7.264,27.293h1.382h11h17.382l-4,8H3.264L7.264,27.293z M7.646,52.001V37.293h26\r\nc0.379,0,0.725-0.36,0.894-0.699l3.106-6.357v25.056h-10V44.001c0-0.347-0.18-0.668-0.474-0.851\r\nc-0.295-0.184-0.664-0.198-0.973-0.044l-1.553,0.776l-1.553-0.776c-0.282-0.141-0.613-0.141-0.895,0l-1.552,0.776l-1.553-0.776\r\nc-0.31-0.154-0.678-0.14-0.973,0.044c-0.294,0.183-0.474,0.504-0.474,0.851v11.292h-7C8.992,55.293,7.646,53.655,7.646,52.001z\r\n M19.646,55.293v-9.674l0.553,0.276c0.281,0.141,0.613,0.141,0.895,0l1.552-0.776l1.553,0.776c0.282,0.141,0.613,0.141,0.895,0\r\nl0.552-0.276v9.674H19.646z M49.646,52.001c0,1.654-1.346,3.292-3,3.292h-7V30.237l3.105,6.357\r\nc0.17,0.339,0.516,0.699,0.895,0.699h6V52.001z M44.264,35.293l-4-8h8.382h1.382l4,8H44.264z"}),r("circle",{cx:"25.646",cy:"18.001",r:"1"}),r("circle",{cx:"31.646",cy:"18.001",r:"1"}),r("path",{d:"M8.646,23.293h2c0-6-4.486-10.292-10-10.292v2C5.057,15.001,8.646,18.293,8.646,23.293z"}),r("path",{d:"M12.646,14.293h2c0-8-5.832-13.293-13-13.293v2C7.711,3,12.646,7.293,12.646,14.293z"}),r("path",{d:"M23.646,10.293h2c0-5-4.038-9.292-9-9.292v2C20.507,3,23.646,6.293,23.646,10.293z"}),r("path",{d:"M46.646,23.293h2c0-5,3.589-8.292,8-8.292v-2C51.132,13.001,46.646,17.293,46.646,23.293z"}),r("path",{d:"M55.646,3V1c-7.169,0-13,5.293-13,13.293h2C44.646,7.293,49.582,3,55.646,3z"}),r("path",{d:"M40.646,3V1c-4.962,0-9,4.293-9,9.293h2C33.646,6.293,36.786,3,40.646,3z"}),r("rect",{x:"12.646",y:"16.001",width:"2",height:"2"}),r("rect",{x:"12.646",y:"20.001",width:"2",height:"2"}),r("rect",{x:"42.646",y:"16.001",width:"2",height:"2"}),r("rect",{x:"42.646",y:"20.001",width:"2",height:"2"}),r("rect",{x:"12.646",y:"1",width:"2",height:"2"}),r("rect",{x:"42.646",y:"1",width:"2",height:"2"}),r("rect",{x:"27.646",y:"8.001",width:"2",height:"2"}),r("rect",{x:"27.646",y:"4",width:"2",height:"2"}),r("rect",{x:"27.646",width:"2",height:"2"}),r("rect",{x:"17.646",y:"8.001",width:"2",height:"2"}),r("rect",{x:"37.646",y:"8.001",width:"2",height:"2"})])]),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g"),r("g")],-1),R={class:"text-2xl font-semibold uppercase p-3"},q={class:"text-gray-500"},S={class:"h-[100%] w-full flex flex-col"},O={class:"row-span-1"},T=["onClick"],K={class:"bg-white h-full row-span-10 overflow-y-auto"},W={class:"form-container"},Y=["src"],G=r("p",{class:"text-gray-500 text-xs italic"}," Imagen referencial del producto. ",-1),J={class:"form-container"},Q=r("label",{for:"categoria",class:"form-label"},"Categoria",-1),X=["value"],Z={class:"form-container"},ee=r("label",{for:"txtNombre",class:"form-label"},"Nombre del Producto:",-1),te={class:"form-container"},re={for:"txtCodigoBarra",class:"form-label flex gap-2"},oe=c("Codigo de Barra: "),ae={class:"row-span-1 flex items-center w-full"},ie={class:"form-container w-1/2"},le=r("label",{for:"unidad",class:"form-label"},"Unidad",-1),ne=["value"],de={class:"mt-4"},se={class:"rounded-xl overflow-auto bg-white row-span-4"},ce={class:"grid grid-cols-2 items-center px-5 row-span-1 bg-gray-100"},ue=c(" Agregar Presentaciones "),ge=c(" Configurar el producto "),he=l({setup(o){const i=P(),l=B(),E=k(),F=A(),z=V(),U=a(!1),_=a(!1),N=a({}),L=a(0),he=["Producto","Presentaciones"],pe=a({}),me=a(!1);n((()=>{i.filterData("")}));const ve=()=>(Math.floor(9e5*Math.random())+1e5).toString(),fe=e=>{i.filterData(e)},xe=async()=>{i.clearModel(),F.clearModel(),i.storeModel.CodigoBarra=ve(),await l.setData(),await E.setData()},ye=async({Id:e,Nombre:t,Categoria_Id:r,CodigoBarra:o,Imagen:a})=>{var n;if(!e)return void(U.value=!1);_.value=!0,i.clearModel(),F.clearModel(),await l.setData(),await E.setData();const d=l.getData.find((e=>e.id===r));d||b({title:"Error",description:"No se pudo cargar la categoria!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),i.storeModel.id=e,i.storeModel.Categoria=null!=(n=null==d?void 0:d.id)?n:0,i.storeModel.Nombre=t,i.storeModel.CodigoBarra=o||ve(),i.storeModel.Imagen=a;await F.get_producto_unidad_by_producto_id(e)||b({title:"Error",description:"No se pudo cargar las presentaciones!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),_.value=!1,U.value=!0},we=async()=>{if(!i.isValidFormModel)return b({title:"Error",description:"El formulario de Producto es invÃ¡lido!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(me.value=!1);if(!F.isValidFormModel)return b({title:"Error",description:"Ingrese las presentaciones del producto!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(me.value=!1);_.value=!0;const e=await i.saveData();if(!e)return b({title:"Error",description:"Ingrese las presentaciones del producto!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(_.value=!1);const t=e;if(!(await F.saveData(t.id)))return b({title:"Error",description:"Ingrese las presentaciones del producto!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(_.value=!1);U.value=me.value=!1,b({title:"Exitoso",description:"OperaciÃ³n completada con Ã©xito! ðŸ˜Š"},{type:"success",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),_.value=!1,i.filterData("")},be=e=>{U.value=e,L.value=0},Me=e=>{if(!e)return"";return 0===e.indexOf("data:image")?e:`${z.getBaseMediaUrl}${e}`},Ce=async e=>{await F.deleteData(e)?b({title:"Exitoso",description:"El registro se ha eliminado correctamente"},{type:"success",timeout:3e3,position:"bottom-right",hideProgressBar:!0}):b({title:"Error",description:"No se pudo eliminar el registro"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0})};return(o,a)=>{const n=D,P=M,B=j,V=H,k=C,z=I;return e(),t(h,null,[d(k,{columns:g(i).getColumns,data:g(i).getData||[],count:g(i).getCounts,titulo:g(i).keyModel,subtitulo:`Listado de ${g(i).keyModel}s`,"show-modal":U.value,"modal-width":"50rem","modal-height":"50rem","show-loading":_.value,onAddEvent:xe,onUpdateEvent:ye,onFilterEvent:fe,onModalIsOpen:be},{imagen:s((()=>[$])),cabecera:s((()=>[r("h1",R,[c(u(g(i).storeModel.id?"Editar":"Nuevo")+" "+u(g(i).keyModel)+" ",1),r("b",q,u(g(i).storeModel.id),1)])])),cuerpo:s((()=>[r("div",S,[r("section",O,[(e(),t(h,null,p(he,((e,t)=>r("button",{key:t,class:m(["text-gray-600 focus:outline-none font-medium rounded-lg p-2 text-xs",{"border-green-500 border-b-2 shadow-lg transition  duration-300 ease-in-out transform hover:-translate-y-1 hover:scale-100":L.value===t," rounded-none rounded-r-lg":0==t}]),onClick:e=>L.value=t},u(e),11,T))),64))]),r("section",K,[r("form",{class:m(["form-container h-full p-3",0==L.value?"grid":"hidden"]),onSubmit:a[5]||(a[5]=v((()=>{}),["prevent"]))},[r("input",{id:"file",class:"hidden",type:"file",placeholder:"Imagen",accept:"image/png, image/jpeg, image/jpg",onChange:a[0]||(a[0]=e=>(async()=>{const e=document.getElementById("file");if(!e)return;const t=e.files;if(!t)return;const r=t[0];if(!r)return;const o=new FileReader;"image/png"===r.type||"image/jpeg"===r.type||"image/webp"===r.type?r.size>1e6?b({title:"Error",description:"El archivo no puede ser mayor a 1mb"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}):(o.readAsDataURL(r),o.onload=()=>{i.storeModel.Imagen=o.result}):b({title:"Error",description:"Solo se aceptan formatos .png, .jpg y .jpeg"},{type:"warning",timeout:3e3,position:"bottom-right",hideProgressBar:!0})})())},null,32),r("div",W,[r("div",{class:"rounded-lg w-[150px] h-[130px] flex flex-col items-center justify-center m-auto",onClick:a[1]||(a[1]=e=>(()=>{const e=document.getElementById("file");e&&e.click()})())},[r("img",{class:"w-[85%] h-[85%] bg-cover flex text-center items-center justify-center rounded-lg",src:Me(g(i).storeModel.Imagen),alt:"imagen"},null,8,Y),G])]),r("div",J,[Q,f(r("select",{id:"categoria","onUpdate:modelValue":a[2]||(a[2]=e=>g(i).storeModel.Categoria=e),class:"form-input w-full focus:text-black lg:w-[50%] bg-green-500 text-white",required:""},[(e(!0),t(h,null,p(g(l).getData,((r,o)=>(e(),t("option",{key:o,value:r.id,class:"text-gray-700"},u(r.Nombre),9,X)))),128))],512),[[x,g(i).storeModel.Categoria]])]),r("div",Z,[ee,f(r("input",{id:"txtNombre","onUpdate:modelValue":a[3]||(a[3]=e=>g(i).storeModel.Nombre=e),autofocus:"",type:"text",class:"form-input sm:w-full lg:w-[100%]",placeholder:"Nombre del Producto",required:""},null,512),[[y,g(i).storeModel.Nombre]])]),r("div",te,[r("label",re,[oe,d(n,{class:"font-bold"})]),f(r("input",{id:"txtCodigoBarra","onUpdate:modelValue":a[4]||(a[4]=e=>g(i).storeModel.CodigoBarra=e),type:"text",class:"form-input w-full",placeholder:"Codigo de Barra",required:""},null,512),[[y,g(i).storeModel.CodigoBarra]])])],34),r("section",{class:m(["form-container h-full p-3 grid grid-rows-5",1==L.value?"flex":"hidden"])},[r("div",ae,[r("div",ie,[le,f(r("select",{id:"unidad","onUpdate:modelValue":a[6]||(a[6]=e=>N.value=e),class:"form-input w-full focus:text-black bg-gray-500 text-white",required:""},[(e(!0),t(h,null,p(g(E).getData,((r,o)=>(e(),t("option",{key:o,value:r,class:"text-gray-700"},u(r.Nombre),9,ne)))),128))],512),[[x,N.value]])]),r("div",de,[r("button",{class:"btn-submit",onClick:a[7]||(a[7]=e=>(()=>{var e;if(!N.value)return;const t={Id:null!=(e=pe.value.Id)?e:0,UnidadId:N.value.id,Unidad:N.value.Nombre,Factor:N.value.Factor,Precio:0,IsPrincipal:0===F.getData.length};if(t.Principal=t.IsPrincipal?"SÃ­":"No",F.ExistUnidad(t.UnidadId))return void b({title:"Unidad Existe",description:"La unidad ya estÃ¡ en la lista! ðŸ˜Š"},{type:"danger",position:"bottom-right",hideProgressBar:!0});F.addList(t)||b({title:"Ocurrio un problema",description:"No se pudo agregar la unidad a la lista!"},{type:"danger"}),N.value={}})())}," Guardar ")])]),r("section",se,[d(P,{columns:g(F).getColumns||[],data:g(F).getData||[],actions:!0,class:"row-span-4","link-id":!1,onDeleteRow:Ce},null,8,["columns","data"])])],2)])])])),acciones:s((()=>[r("div",ce,[r("button",{class:"btn-submit text-white font-bold py-2 px-4 rounded-lg",onClick:a[8]||(a[8]=e=>i.isValidFormModel?F.isValidFormModel?void(me.value=!0):(b({title:"Error",description:"Ingrese las presentaciones del producto!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(me.value=!1)):(b({title:"Error",description:"El formulario de Producto es invÃ¡lido!"},{type:"danger",timeout:3e3,position:"bottom-right",hideProgressBar:!0}),void(me.value=!1)))}," Guardar "),0==L.value?(e(),t("button",{key:0,class:"text-xs text-gray-800 text-center bg-blue-100 px-2 p-1 rounded-lg underline text-left flex items-center justify-center",onClick:a[9]||(a[9]=e=>L.value=1)},[ue,d(B)])):w("",!0),1==L.value?(e(),t("button",{key:1,class:"text-xs text-gray-800 text-center bg-red-100 px-2 p-1 rounded-lg underline text-left flex items-center justify-center",onClick:a[10]||(a[10]=e=>L.value=0)},[d(V),ge])):w("",!0)])])),_:1},8,["columns","data","count","titulo","subtitulo","show-modal","show-loading"]),d(z,{"show-modal":me.value,"modal-width":"20rem","modal-height":"10rem",description:"Seguro que desea guardar los datos?",onConfirm:we,onCancel:a[11]||(a[11]=e=>me.value=!1)},null,8,["show-modal"])],64)}}});export{he as default};
